<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Chat cifrado con César</title>
    <style>
        body { background:#1e293b; color:white; font-family:Arial; }
        #chat { width:60%; height:300px; background:#0f172a; margin:auto; overflow-y:auto; padding:10px; border-radius:10px; }
        input { padding:10px; margin:5px; border-radius:5px; border:none; }
        button { padding:10px; border:none; background:#0284c7; color:white; border-radius:5px; cursor:pointer; }
    </style>
</head>
<body>

<h1 style="text-align:center;">Chat cifrado con César</h1>

<div style="text-align:center;">
    <input id="name" placeholder="Tu nombre">
    <input id="shift" placeholder="Desplazamiento">
    <button onclick="joinChat()">Entrar al chat</button>
</div>

<div id="chat"></div>

<div style="text-align:center; margin-top:10px;">
    <input id="msg" placeholder="Escribe un mensaje..." style="width:60%;">
    <button onclick="sendMessage()">Enviar</button>
</div>

<script>
let ws;
let username = "";
let shift = 0;

function joinChat(){
    username = document.getElementById("name").value;
    shift = parseInt(document.getElementById("shift").value);

    if(!username || isNaN(shift)){
        alert("Completa nombre y desplazamiento");
        return;
    }

    // CONÉCTATE AL WEBSOCKET DE RENDER
    ws = new WebSocket("wss://TU-PROYECTO.onrender.com/ws/chat");

    ws.onmessage = (event) => {
        const chat = document.getElementById("chat");
        chat.innerHTML += event.data + "<br>";
        chat.scrollTop = chat.scrollHeight;
    };

    ws.onopen = () => alert("Conectado al chat");
}

function sendMessage(){
    const text = document.getElementById("msg").value;
    if(!text) return;

    const data = {
        name: username,
        message: text,
        shift: shift
    };

    ws.send(JSON.stringify(data));
    document.getElementById("msg").value = "";
}
</script>

</body>
</html>
